Loss functions are coded and shared by zhedong zheng.